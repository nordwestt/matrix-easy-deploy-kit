# coturn TURN server configuration
# Generated by matrix-easy-deploy setup.sh — do not edit by hand.
# Full reference: https://github.com/coturn/coturn/wiki/turnserver

# ---------------------------------------------------------------------------
# Network
# ---------------------------------------------------------------------------
listening-port=3478
tls-listening-port=5349
listening-ip=0.0.0.0
relay-ip=0.0.0.0

# The server's public IP address.  Required when the server is behind NAT.
external-ip={{SERVER_IP}}

# ---------------------------------------------------------------------------
# Identity
# ---------------------------------------------------------------------------
realm={{MATRIX_DOMAIN}}
server-name={{MATRIX_DOMAIN}}

# ---------------------------------------------------------------------------
# Authentication
# HMAC-SHA1 time-limited credentials — no user database required.
# Synapse generates short-lived tokens using the same secret.
# ---------------------------------------------------------------------------
use-auth-secret
static-auth-secret={{COTURN_SECRET}}

# ---------------------------------------------------------------------------
# UDP relay port range
# These must match the ports exposed in docker-compose.yml.
# A range of ~250 ports is plenty for a small homeserver.
# ---------------------------------------------------------------------------
min-port=49152
max-port=49400

# ---------------------------------------------------------------------------
# Security — block relaying to private / link-local ranges
# ---------------------------------------------------------------------------
no-multicast-peers
denied-peer-ip=10.0.0.0-10.255.255.255
denied-peer-ip=192.168.0.0-192.168.255.255
denied-peer-ip=172.16.0.0-172.31.255.255
denied-peer-ip=100.64.0.0-100.127.255.255
denied-peer-ip=127.0.0.0-127.255.255.255
denied-peer-ip=169.254.0.0-169.254.255.255

# ---------------------------------------------------------------------------
# Logging
# ---------------------------------------------------------------------------
log-file=stdout
simple-log
